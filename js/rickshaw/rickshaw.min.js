var Rickshaw={namespace:function(d,g){var f=d.split(".");var c=Rickshaw;for(var b=1,e=f.length;b<e;b++){var a=f[b];c[a]=c[a]||{};c=c[a]}return c},keys:function(c){var b=[];for(var a in c){b.push(a)}return b},extend:function(a,c){for(var b in c){a[b]=c[b]}return a},clone:function(a){return JSON.parse(JSON.stringify(a))}};if(typeof module!=="undefined"&&module.exports){var d3=require("d3");module.exports=Rickshaw}(function(v){var s=Object.prototype.toString,r="Null",i="Undefined",n="Boolean",c="Number",l="String",t="Object",m="[object Function]";function a(w){return s.call(w)===m}function q(w,y){for(var x in y){if(y.hasOwnProperty(x)){w[x]=y[x]}}return w}function k(w){if(h(w)!==t){throw new TypeError()}var x=[];for(var y in w){if(w.hasOwnProperty(y)){x.push(y)}}return x}function h(x){switch(x){case null:return r;case (void 0):return i}var w=typeof x;switch(w){case"boolean":return n;case"number":return c;case"string":return l}return t}function b(w){return typeof w==="undefined"}var o=Array.prototype.slice;function e(w){var x=w.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return x.length==1&&!x[0]?[]:x}function g(x,y){var w=x;return function(){var z=f([u(w,this)],arguments);return y.apply(this,z)}}function f(z,w){var y=z.length,x=w.length;while(x--){z[y+x]=w[x]}return z}function d(x,w){x=o.call(x,0);return f(x,w)}function u(z,y){if(arguments.length<2&&b(arguments[0])){return this}var w=z,x=o.call(arguments,2);return function(){var A=d(x,arguments);return w.apply(y,A)}}var j=function(){};var p=(function(){var z=(function(){for(var A in {toString:1}){if(A==="toString"){return false}}return true})();function w(){}function x(){var D=null,C=[].slice.apply(arguments);if(a(C[0])){D=C.shift()}function A(){this.initialize.apply(this,arguments)}q(A,p.Methods);A.superclass=D;A.subclasses=[];if(D){w.prototype=D.prototype;A.prototype=new w;try{D.subclasses.push(A)}catch(F){}}for(var B=0,E=C.length;B<E;B++){A.addMethods(C[B])}if(!A.prototype.initialize){A.prototype.initialize=j}A.prototype.constructor=A;return A}function y(G){var C=this.superclass&&this.superclass.prototype,B=k(G);if(z){if(G.toString!=Object.prototype.toString){B.push("toString")}if(G.valueOf!=Object.prototype.valueOf){B.push("valueOf")}}for(var A=0,D=B.length;A<D;A++){var F=B[A],E=G[F];if(C&&a(E)&&e(E)[0]=="$super"){var H=E;E=g((function(I){return function(){return C[I].apply(this,arguments)}})(F),H);E.valueOf=u(H.valueOf,H);E.toString=u(H.toString,H)}this.prototype[F]=E}return this}return{create:x,Methods:{addMethods:y}}})();if(v.exports){v.exports.Class=p}else{v.Class=p}})(Rickshaw);Rickshaw.namespace("Rickshaw.Compat.ClassList");Rickshaw.Compat.ClassList=function(){if(typeof document!=="undefined"&&!("classList" in document.createElement("a"))){(function(j){var a="classList",f="prototype",m=(j.HTMLElement||j.Element)[f],b=Object,k=String[f].trim||function(){return this.replace(/^\s+|\s+$/g,"")},c=Array[f].indexOf||function(q){var p=0,o=this.length;for(;p<o;p++){if(p in this&&this[p]===q){return p}}return -1},n=function(o,p){this.name=o;this.code=DOMException[o];this.message=p},g=function(p,o){if(o===""){throw new n("SYNTAX_ERR","An invalid or illegal string was specified")}if(/\s/.test(o)){throw new n("INVALID_CHARACTER_ERR","String contains an invalid character")}return c.call(p,o)},d=function(s){var r=k.call(s.className),q=r?r.split(/\s+/):[],p=0,o=q.length;for(;p<o;p++){this.push(q[p])}this._updateClassName=function(){s.className=this.toString()}},e=d[f]=[],i=function(){return new d(this)};n[f]=Error[f];e.item=function(o){return this[o]||null};e.contains=function(o){o+="";return g(this,o)!==-1};e.add=function(o){o+="";if(g(this,o)===-1){this.push(o);this._updateClassName()}};e.remove=function(p){p+="";var o=g(this,p);if(o!==-1){this.splice(o,1);this._updateClassName()}};e.toggle=function(o){o+="";if(g(this,o)===-1){this.add(o)}else{this.remove(o)}};e.toString=function(){return this.join(" ")};if(b.defineProperty){var l={get:i,enumerable:true,configurable:true};try{b.defineProperty(m,a,l)}catch(h){if(h.number===-2146823252){l.enumerable=false;b.defineProperty(m,a,l)}}}else{if(b[f].__defineGetter__){m.__defineGetter__(a,i)}}}(window))}};if((typeof RICKSHAW_NO_COMPAT!=="undefined"&&!RICKSHAW_NO_COMPAT)||typeof RICKSHAW_NO_COMPAT==="undefined"){new Rickshaw.Compat.ClassList()}Rickshaw.namespace("Rickshaw.Graph");Rickshaw.Graph=function(b){if(!b.element){throw"Rickshaw.Graph needs a reference to an element"}this.element=b.element;this.series=b.series;this.defaults={interpolation:"cardinal",offset:"zero",min:undefined,max:undefined,preserve:false};Rickshaw.keys(this.defaults).forEach(function(c){this[c]=b[c]||this.defaults[c]},this);this.window={};this.updateCallbacks=[];var a=this;this.initialize=function(d){this.validateSeries(d.series);this.series.active=function(){return a.series.filter(function(e){return !e.disabled})};this.setSize({width:d.width,height:d.height});this.element.classList.add("rickshaw_graph");this.vis=d3.select(this.element).append("svg:svg").attr("width",this.width).attr("height",this.height);var c=[Rickshaw.Graph.Renderer.Stack,Rickshaw.Graph.Renderer.Line,Rickshaw.Graph.Renderer.Bar,Rickshaw.Graph.Renderer.Area,Rickshaw.Graph.Renderer.ScatterPlot];c.forEach(function(e){if(!e){return}a.registerRenderer(new e({graph:a}))});this.setRenderer(d.renderer||"stack",d);this.discoverRange()};this.validateSeries=function(d){if(!Array.isArray(d)&&!(d instanceof Rickshaw.Series)){var c=Object.prototype.toString.apply(d);throw"series is not an array: "+c}var e;d.forEach(function(g){if(!(g instanceof Object)){throw"series element is not an object: "+g}if(!(g.data)){throw"series has no data: "+JSON.stringify(g)}if(!Array.isArray(g.data)){throw"series data is not an array: "+JSON.stringify(g.data)}var f=g.data[0].x;var h=g.data[0].y;if(typeof f!="number"||(typeof h!="number"&&h!==null)){throw"x and y properties of points should be numbers instead of "+(typeof f)+" and "+(typeof h)}},this)};this.dataDomain=function(){var c=this.series[0].data;return[c[0].x,c.slice(-1).shift().x]};this.discoverRange=function(){var c=this.renderer.domain();this.x=d3.scale.linear().domain(c.x).range([0,this.width]);this.y=d3.scale.linear().domain(c.y).range([this.height,0]);this.y.magnitude=d3.scale.linear().domain([c.y[0]-c.y[0],c.y[1]-c.y[0]]).range([0,this.height])};this.render=function(){var c=this.stackData();this.discoverRange();this.renderer.render();this.updateCallbacks.forEach(function(d){d()})};this.update=this.render;this.stackData=function(){var f=this.series.active().map(function(g){return g.data}).map(function(g){return g.filter(function(h){return this._slice(h)},this)},this);var d=this.preserve;if(!d){this.series.forEach(function(g){if(g.scale){d=true}})}f=d?Rickshaw.clone(f):f;this.series.forEach(function(i,g){if(i.scale){var h=f[g];h.forEach(function(j){j.y=i.scale(j.y)})}});this.stackData.hooks.data.forEach(function(g){f=g.f.apply(a,[f])});var c;if(!this.renderer.unstack){this._validateStackable();var e=d3.layout.stack();e.offset(a.offset);c=e(f)}c=c||f;this.stackData.hooks.after.forEach(function(g){c=g.f.apply(a,[f])});this.series.forEach(function(h,g){if(h.disabled){return}h.stack=c[g]});this.stackedData=c;return c};this._validateStackable=function(){var c=this.series;var d;c.forEach(function(e){d=d||e.data.length;if(d&&e.data.length!=d){throw"stacked series cannot have differing numbers of points: "+d+" vs "+e.data.length+"; see Rickshaw.Series.fill()"}},this)};this.stackData.hooks={data:[],after:[]};this._slice=function(e){if(this.window.xMin||this.window.xMax){var c=true;if(this.window.xMin&&e.x<this.window.xMin){c=false}if(this.window.xMax&&e.x>this.window.xMax){c=false}return c}return true};this.onUpdate=function(c){this.updateCallbacks.push(c)};this.registerRenderer=function(c){this._renderers=this._renderers||{};this._renderers[c.name]=c};this.configure=function(c){if(c.width||c.height){this.setSize(c)}Rickshaw.keys(this.defaults).forEach(function(d){this[d]=d in c?c[d]:d in this?this[d]:this.defaults[d]},this);this.setRenderer(c.renderer||this.renderer.name,c)};this.setRenderer=function(d,c){if(typeof d=="function"){this.renderer=new d({graph:a});this.registerRenderer(this.renderer)}else{if(!this._renderers[d]){throw"couldn't find renderer "+d}this.renderer=this._renderers[d]}if(typeof c=="object"){this.renderer.configure(c)}};this.setSize=function(c){c=c||{};if(typeof window!==undefined){var e=window.getComputedStyle(this.element,null);var f=parseInt(e.getPropertyValue("width"),10);var d=parseInt(e.getPropertyValue("height"),10)}this.width=c.width||f||400;this.height=c.height||d||250;this.vis&&this.vis.attr("width",this.width).attr("height",this.height)};this.initialize(b)};Rickshaw.namespace("Rickshaw.Fixtures.Color");Rickshaw.Fixtures.Color=function(){this.schemes={};this.schemes.spectrum14=["#ecb796","#dc8f70","#b2a470","#92875a","#716c49","#d2ed82","#bbe468","#a1d05d","#e7cbe6","#d8aad6","#a888c2","#9dc2d3","#649eb9","#387aa3"].reverse();this.schemes.spectrum2000=["#57306f","#514c76","#646583","#738394","#6b9c7d","#84b665","#a7ca50","#bfe746","#e2f528","#fff726","#ecdd00","#d4b11d","#de8800","#de4800","#c91515","#9a0000","#7b0429","#580839","#31082b"];this.schemes.spectrum2001=["#2f243f","#3c2c55","#4a3768","#565270","#6b6b7c","#72957f","#86ad6e","#a1bc5e","#b8d954","#d3e04e","#ccad2a","#cc8412","#c1521d","#ad3821","#8a1010","#681717","#531e1e","#3d1818","#320a1b"];this.schemes.classic9=["#423d4f","#4a6860","#848f39","#a2b73c","#ddcb53","#c5a32f","#7d5836","#963b20","#7c2626","#491d37","#2f254a"].reverse();this.schemes.httpStatus={503:"#ea5029",502:"#d23f14",500:"#bf3613",410:"#efacea",409:"#e291dc",403:"#f457e8",408:"#e121d2",401:"#b92dae",405:"#f47ceb",404:"#a82a9f",400:"#b263c6",301:"#6fa024",302:"#87c32b",307:"#a0d84c",304:"#28b55c",200:"#1a4f74",206:"#27839f",201:"#52adc9",202:"#7c979f",203:"#a5b8bd",204:"#c1cdd1"};this.schemes.colorwheel=["#b5b6a9","#858772","#785f43","#96557e","#4682b4","#65b9ac","#73c03a","#cb513a"].reverse();this.schemes.cool=["#5e9d2f","#73c03a","#4682b4","#7bc3b8","#a9884e","#c1b266","#a47493","#c09fb5"];this.schemes.munin=["#00cc00","#0066b3","#ff8000","#ffcc00","#330099","#990099","#ccff00","#ff0000","#808080","#008f00","#00487d","#b35a00","#b38f00","#6b006b","#8fb300","#b30000","#bebebe","#80ff80","#80c9ff","#ffc080","#ffe680","#aa80ff","#ee00cc","#ff8080","#666600","#ffbfff","#00ffcc","#cc6699","#999900"]};Rickshaw.namespace("Rickshaw.Fixtures.RandomData");Rickshaw.Fixtures.RandomData=function(b){var d;b=b||1;var a=200;var c=Math.floor(new Date().getTime()/1000);this.addData=function(h){var g=Math.random()*100+15+a;var f=h[0].length;var e=1;h.forEach(function(j){var k=Math.random()*20;var i=g/25+e+++(Math.cos((f*e*11)/960)+2)*15+(Math.cos(f/7)+2)*7+(Math.cos(f/17)+2)*1;j.push({x:(f*b)+c,y:i+k})});a=g*0.85}};Rickshaw.namespace("Rickshaw.Fixtures.Time");Rickshaw.Fixtures.Time=function(){var a=new Date().getTimezoneOffset()*60;var b=this;this.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];this.units=[{name:"decade",seconds:86400*365.25*10,formatter:function(c){return(parseInt(c.getUTCFullYear()/10,10)*10)}},{name:"year",seconds:86400*365.25,formatter:function(c){return c.getUTCFullYear()}},{name:"month",seconds:86400*30.5,formatter:function(c){return b.months[c.getUTCMonth()]}},{name:"week",seconds:86400*7,formatter:function(c){return b.formatDate(c)}},{name:"day",seconds:86400,formatter:function(c){return c.getUTCDate()}},{name:"6 hour",seconds:3600*6,formatter:function(c){return b.formatTime(c)}},{name:"hour",seconds:3600,formatter:function(c){return b.formatTime(c)}},{name:"15 minute",seconds:60*15,formatter:function(c){return b.formatTime(c)}},{name:"minute",seconds:60,formatter:function(c){return c.getUTCMinutes()}},{name:"15 second",seconds:15,formatter:function(c){return c.getUTCSeconds()+"s"}},{name:"second",seconds:1,formatter:function(c){return c.getUTCSeconds()+"s"}}];this.unit=function(c){return this.units.filter(function(d){return c==d.name}).shift()};this.formatDate=function(c){return c.toUTCString().match(/, (\w+ \w+ \w+)/)[1]};this.formatTime=function(c){return c.toUTCString().match(/(\d+:\d+):/)[1]};this.ceil=function(f,d){var e;var c;if(d.name=="month"){e=new Date((f+d.seconds-1)*1000);c=new Date(0);c.setUTCFullYear(e.getUTCFullYear());c.setUTCMonth(e.getUTCMonth());c.setUTCDate(1);c.setUTCHours(0);c.setUTCMinutes(0);c.setUTCSeconds(0);c.setUTCMilliseconds(0);return c.getTime()/1000}if(d.name=="year"){e=new Date((f+d.seconds-1)*1000);c=new Date(0);c.setUTCFullYear(e.getUTCFullYear());c.setUTCMonth(0);c.setUTCDate(1);c.setUTCHours(0);c.setUTCMinutes(0);c.setUTCSeconds(0);c.setUTCMilliseconds(0);return c.getTime()/1000}return Math.ceil(f/d.seconds)*d.seconds}};Rickshaw.namespace("Rickshaw.Fixtures.LocalTime");Rickshaw.Fixtures.LocalTime=function(){var a=new Date().getTimezoneOffset()*60;var b=this;this.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];this.units=[{name:"decade",seconds:86400*365.25*10,formatter:function(c){return(parseInt(c.getFullYear()/10,10)*10)}},{name:"year",seconds:86400*365.25,formatter:function(c){return c.getFullYear()}},{name:"month",seconds:86400*30.5,formatter:function(c){return b.months[c.getMonth()]}},{name:"week",seconds:86400*7,formatter:function(c){return b.formatDate(c)}},{name:"day",seconds:86400,formatter:function(c){return c.getDate()}},{name:"6 hour",seconds:3600*6,formatter:function(c){return b.formatTime(c)}},{name:"hour",seconds:3600,formatter:function(c){return b.formatTime(c)}},{name:"15 minute",seconds:60*15,formatter:function(c){return b.formatTime(c)}},{name:"minute",seconds:60,formatter:function(c){return c.getMinutes()}},{name:"15 second",seconds:15,formatter:function(c){return c.getSeconds()+"s"}},{name:"second",seconds:1,formatter:function(c){return c.getSeconds()+"s"}}];this.unit=function(c){return this.units.filter(function(d){return c==d.name}).shift()};this.formatDate=function(c){return c.toString().match(/, (\w+ \w+ \w+)/)[1]};this.formatTime=function(c){return c.toString().match(/(\d+:\d+):/)[1]};this.ceil=function(f,d){var e;var c;if(d.name=="month"){e=new Date((f+d.seconds-1)*1000);c=new Date(0);c.setFullYear(e.getFullYear());c.setMonth(e.getMonth());c.setDate(1);c.setHours(0);c.setMinutes(0);c.setSeconds(0);c.setMilliseconds(0);return c.getTime()/1000}if(d.name=="year"){e=new Date((f+d.seconds-1)*1000);c=new Date(0);c.setFullYear(e.getFullYear());c.setMonth(0);c.setDate(1);c.setHours(0);c.setMinutes(0);c.setSeconds(0);c.setMilliseconds(0);return c.getTime()/1000}return Math.ceil(f/d.seconds)*d.seconds}};Rickshaw.namespace("Rickshaw.Fixtures.Number");Rickshaw.Fixtures.Number.formatKMBT=function(b){var a=Math.abs(b);if(a>=1000000000000){return b/1000000000000+"T"}else{if(a>=1000000000){return b/1000000000+"B"}else{if(a>=1000000){return b/1000000+"M"}else{if(a>=1000){return b/1000+"K"}else{if(a<1&&b>0){return b.toFixed(2)}else{if(a===0){return""}else{return b}}}}}}};Rickshaw.Fixtures.Number.formatBase1024KMGTP=function(b){var a=Math.abs(b);if(a>=1125899906842624){return b/1125899906842624+"P"}else{if(a>=1099511627776){return b/1099511627776+"T"}else{if(a>=1073741824){return b/1073741824+"G"}else{if(a>=1048576){return b/1048576+"M"}else{if(a>=1024){return b/1024+"K"}else{if(a<1&&b>0){return b.toFixed(2)}else{if(a===0){return""}else{return b}}}}}}}};Rickshaw.namespace("Rickshaw.Color.Palette");Rickshaw.Color.Palette=function(e){var b=new Rickshaw.Fixtures.Color();e=e||{};this.schemes={};this.scheme=b.schemes[e.scheme]||e.scheme||b.schemes.colorwheel;this.runningIndex=0;this.generatorIndex=0;if(e.interpolatedStopCount){var d=this.scheme.length-1;var f,c,a=[];for(f=0;f<d;f++){a.push(this.scheme[f]);var g=d3.interpolateHsl(this.scheme[f],this.scheme[f+1]);for(c=1;c<e.interpolatedStopCount;c++){a.push(g((1/e.interpolatedStopCount)*c))}}a.push(this.scheme[this.scheme.length-1]);this.scheme=a}this.rotateCount=this.scheme.length;this.color=function(h){return this.scheme[h]||this.scheme[this.runningIndex++]||this.interpolateColor()||"#808080"};this.interpolateColor=function(){if(!Array.isArray(this.scheme)){return}var h;if(this.generatorIndex==this.rotateCount*2-1){h=d3.interpolateHsl(this.scheme[this.generatorIndex],this.scheme[0])(0.5);this.generatorIndex=0;this.rotateCount*=2}else{h=d3.interpolateHsl(this.scheme[this.generatorIndex],this.scheme[this.generatorIndex+1])(0.5);this.generatorIndex++}this.scheme.push(h);return h}};Rickshaw.namespace("Rickshaw.Graph.Ajax");Rickshaw.Graph.Ajax=Rickshaw.Class.create({initialize:function(a){this.dataURL=a.dataURL;this.onData=a.onData||function(b){return b};this.onComplete=a.onComplete||function(){};this.onError=a.onError||function(){};this.args=a;this.request()},request:function(){$.ajax({url:this.dataURL,dataType:"json",success:this.success.bind(this),error:this.error.bind(this)})},error:function(){console.log("error loading dataURL: "+this.dataURL);this.onError(this)},success:function(b,a){b=this.onData(b);this.args.series=this._splice({data:b,series:this.args.series});this.graph=this.graph||new Rickshaw.Graph(this.args);this.graph.render();this.onComplete(this)},_splice:function(a){var c=a.data;var b=a.series;if(!a.series){return c}b.forEach(function(e){var d=e.key||e.name;if(!d){throw"series needs a key or a name"}c.forEach(function(h){var g=h.key||h.name;if(!g){throw"data needs a key or a name"}if(d==g){var f=["color","name","data"];f.forEach(function(i){if(h[i]){e[i]=h[i]}})}})});return b}});Rickshaw.namespace("Rickshaw.Graph.Annotate");Rickshaw.Graph.Annotate=function(b){var c=this.graph=b.graph;this.elements={timeline:b.element};var a=this;this.data={};this.elements.timeline.classList.add("rickshaw_annotation_timeline");this.add=function(f,e,d){a.data[f]=a.data[f]||{boxes:[]};a.data[f].boxes.push({content:e,end:d})};this.update=function(){Rickshaw.keys(a.data).forEach(function(g){var d=a.data[g];var f=a.graph.x(g);if(f<0||f>a.graph.x.range()[1]){if(d.element){d.line.classList.add("offscreen");d.element.style.display="none"}d.boxes.forEach(function(h){if(h.rangeElement){h.rangeElement.classList.add("offscreen")}});return}if(!d.element){var e=d.element=document.createElement("div");e.classList.add("annotation");this.elements.timeline.appendChild(e);e.addEventListener("click",function(h){e.classList.toggle("active");d.line.classList.toggle("active");d.boxes.forEach(function(i){if(i.rangeElement){i.rangeElement.classList.toggle("active")}})},false)}d.element.style.left=f+"px";d.element.style.display="block";d.boxes.forEach(function(j){var i=j.element;if(!i){i=j.element=document.createElement("div");i.classList.add("content");i.innerHTML=j.content;d.element.appendChild(i);d.line=document.createElement("div");d.line.classList.add("annotation_line");a.graph.element.appendChild(d.line);if(j.end){j.rangeElement=document.createElement("div");j.rangeElement.classList.add("annotation_range");a.graph.element.appendChild(j.rangeElement)}}if(j.end){var k=f;var l=Math.min(a.graph.x(j.end),a.graph.x.range()[1]);if(k>l){l=f;k=Math.max(a.graph.x(j.end),a.graph.x.range()[0])}var h=l-k;j.rangeElement.style.left=k+"px";j.rangeElement.style.width=h+"px";j.rangeElement.classList.remove("offscreen")}d.line.classList.remove("offscreen");d.line.style.left=f+"px"})},this)};this.graph.onUpdate(function(){a.update()})};Rickshaw.namespace("Rickshaw.Graph.Axis.Time");Rickshaw.Graph.Axis.Time=function(b){var a=this;this.graph=b.graph;this.elements=[];this.ticksTreatment=b.ticksTreatment||"plain";this.fixedTimeUnit=b.timeUnit;var c=b.timeFixtures||new Rickshaw.Fixtures.Time();this.appropriateTimeUnit=function(){var f;var e=c.units;var g=this.graph.x.domain();var d=g[1]-g[0];e.forEach(function(h){if(Math.floor(d/h.seconds)>=2){f=f||h}});return(f||c.units[c.units.length-1])};this.tickOffsets=function(){var k=this.graph.x.domain();var j=this.fixedTimeUnit||this.appropriateTimeUnit();var h=Math.ceil((k[1]-k[0])/j.seconds);var d=k[0];var g=[];for(var f=0;f<h;f++){var e=c.ceil(d,j);d=e+j.seconds/2;g.push({value:e,unit:j})}return g};this.render=function(){this.elements.forEach(function(f){f.parentNode.removeChild(f)});this.elements=[];var d=this.tickOffsets();d.forEach(function(g){if(a.graph.x(g.value)>a.graph.x.range()[1]){return}var e=document.createElement("div");e.style.left=a.graph.x(g.value)+"px";e.classList.add("x_tick");e.classList.add(a.ticksTreatment);var f=document.createElement("div");f.classList.add("title");f.innerHTML=g.unit.formatter(new Date(g.value*1000));e.appendChild(f);a.graph.element.appendChild(e);a.elements.push(e)})};this.graph.onUpdate(function(){a.render()})};Rickshaw.namespace("Rickshaw.Graph.Axis.X");Rickshaw.Graph.Axis.X=function(b){var a=this;var c=0.1;this.initialize=function(d){this.graph=d.graph;this.orientation=d.orientation||"top";var e=d.pixelsPerTick||75;this.ticks=d.ticks||Math.floor(this.graph.width/e);this.tickSize=d.tickSize||4;this.ticksTreatment=d.ticksTreatment||"plain";if(d.element){this.element=d.element;this._discoverSize(d.element,d);this.vis=d3.select(d.element).append("svg:svg").attr("height",this.height).attr("width",this.width).attr("class","rickshaw_graph x_axis_d3");this.element=this.vis[0][0];this.element.style.position="relative";this.setSize({width:d.width,height:d.height})}else{this.vis=this.graph.vis}this.graph.onUpdate(function(){a.render()})};this.setSize=function(e){e=e||{};if(!this.element){return}this._discoverSize(this.element.parentNode,e);this.vis.attr("height",this.height).attr("width",this.width*(1+c));var d=Math.floor(this.width*c/2);this.element.style.left=-1*d+"px"};this.render=function(){if(this.graph.width!==this._renderWidth){this.setSize({auto:true})}var g=d3.svg.axis().scale(this.graph.x).orient(this.orientation);g.tickFormat(b.tickFormat||function(i){return i});var d=Math.floor(this.width*c/2)||0;var f;if(this.orientation=="top"){var h=this.height||this.graph.height;f="translate("+d+","+h+")"}else{f="translate("+d+", 0)"}if(this.element){this.vis.selectAll("*").remove()}this.vis.append("svg:g").attr("class",["x_ticks_d3",this.ticksTreatment].join(" ")).attr("transform",f).call(g.ticks(this.ticks).tickSubdivide(0).tickSize(this.tickSize));var e=(this.orientation=="bottom"?1:-1)*this.graph.height;this.graph.vis.append("svg:g").attr("class","x_grid_d3").call(g.ticks(this.ticks).tickSubdivide(0).tickSize(e));this._renderHeight=this.graph.height};this._discoverSize=function(e,d){if(typeof window!=="undefined"){var g=window.getComputedStyle(e,null);var f=parseInt(g.getPropertyValue("height"),10);if(!d.auto){var h=parseInt(g.getPropertyValue("width"),10)}}this.width=(d.width||h||this.graph.width)*(1+c);this.height=d.height||f||40};this.initialize(b)};Rickshaw.namespace("Rickshaw.Graph.Axis.Y");Rickshaw.Graph.Axis.Y=Rickshaw.Class.create({initialize:function(b){this.graph=b.graph;this.orientation=b.orientation||"right";var c=b.pixelsPerTick||75;this.ticks=b.ticks||Math.floor(this.graph.height/c);this.tickSize=b.tickSize||4;this.ticksTreatment=b.ticksTreatment||"plain";this.tickFormat=b.tickFormat||function(d){return d};this.berthRate=0.1;if(b.element){this.element=b.element;this.vis=d3.select(b.element).append("svg:svg").attr("class","rickshaw_graph y_axis");this.element=this.vis[0][0];this.element.style.position="relative";this.setSize({width:b.width,height:b.height})}else{this.vis=this.graph.vis}var a=this;this.graph.onUpdate(function(){a.render()})},setSize:function(b){b=b||{};if(!this.element){return}if(typeof window!=="undefined"){var d=window.getComputedStyle(this.element.parentNode,null);var e=parseInt(d.getPropertyValue("width"),10);if(!b.auto){var c=parseInt(d.getPropertyValue("height"),10)}}this.width=b.width||e||this.graph.width*this.berthRate;this.height=b.height||c||this.graph.height;this.vis.attr("width",this.width).attr("height",this.height*(1+this.berthRate));var a=this.height*this.berthRate;if(this.orientation=="left"){this.element.style.top=-1*a+"px"}},render:function(){if(this.graph.height!==this._renderHeight){this.setSize({auto:true})}var a=this._drawAxis(this.graph.y);this._drawGrid(a);this._renderHeight=this.graph.height},_drawAxis:function(d){var c=d3.svg.axis().scale(d).orient(this.orientation);c.tickFormat(this.tickFormat);if(this.orientation=="left"){var a=this.height*this.berthRate;var b="translate("+this.width+", "+a+")"}if(this.element){this.vis.selectAll("*").remove()}this.vis.append("svg:g").attr("class",["y_ticks",this.ticksTreatment].join(" ")).attr("transform",b).call(c.ticks(this.ticks).tickSubdivide(0).tickSize(this.tickSize));return c},_drawGrid:function(b){var a=(this.orientation=="right"?1:-1)*this.graph.width;this.graph.vis.append("svg:g").attr("class","y_grid").call(b.ticks(this.ticks).tickSubdivide(0).tickSize(a))}});Rickshaw.namespace("Rickshaw.Graph.Axis.Y.Scaled");Rickshaw.Graph.Axis.Y.Scaled=Rickshaw.Class.create(Rickshaw.Graph.Axis.Y,{initialize:function($super,a){if(typeof(a.scale)==="undefined"){throw new Error("Scaled requires scale")}this.scale=a.scale;if(typeof(a.grid)==="undefined"){this.grid=true}else{this.grid=a.grid}$super(a)},_drawAxis:function($super,b){var a=this.scale.copy().range(b.range());return $super(a)},_drawGrid:function($super,a){if(this.grid){$super(a)}}});Rickshaw.namespace("Rickshaw.Graph.Behavior.Series.Highlight");Rickshaw.Graph.Behavior.Series.Highlight=function(b){this.graph=b.graph;this.legend=b.legend;var a=this;var d={};var c=null;this.addHighlightEvents=function(e){e.element.addEventListener("mouseover",function(f){if(c){return}else{c=e}a.legend.lines.forEach(function(g,i){if(e===g){if(i>0&&a.graph.renderer.unstack){var h=a.graph.series.length-i-1;g.originalIndex=h;var j=a.graph.series.splice(h,1)[0];a.graph.series.push(j)}return}d[g.series.name]=d[g.series.name]||g.series.color;g.series.color=d3.interpolateRgb(g.series.color,d3.rgb("#d8d8d8"))(0.8).toString()});a.graph.update()},false);e.element.addEventListener("mouseout",function(f){if(!c){return}else{c=null}a.legend.lines.forEach(function(g){if(e===g&&g.hasOwnProperty("originalIndex")){var h=a.graph.series.pop();a.graph.series.splice(g.originalIndex,0,h);delete g.originalIndex}if(d[g.series.name]){g.series.color=d[g.series.name]}});a.graph.update()},false)};if(this.legend){this.legend.lines.forEach(function(e){a.addHighlightEvents(e)})}};Rickshaw.namespace("Rickshaw.Graph.Behavior.Series.Order");Rickshaw.Graph.Behavior.Series.Order=function(b){this.graph=b.graph;this.legend=b.legend;var a=this;if(typeof window.$=="undefined"){throw"couldn't find jQuery at window.$"}if(typeof window.$.ui=="undefined"){throw"couldn't find jQuery UI at window.$.ui"}$(function(){$(a.legend.list).sortable({containment:"parent",tolerance:"pointer",update:function(e,f){var d=[];$(a.legend.list).find("li").each(function(g,h){if(!h.series){return}d.push(h.series)});for(var c=a.graph.series.length-1;c>=0;c--){a.graph.series[c]=d.shift()}a.graph.update()}});$(a.legend.list).disableSelection()});this.graph.onUpdate(function(){var c=window.getComputedStyle(a.legend.element).height;a.legend.element.style.height=c})};Rickshaw.namespace("Rickshaw.Graph.Behavior.Series.Toggle");Rickshaw.Graph.Behavior.Series.Toggle=function(b){this.graph=b.graph;this.legend=b.legend;var a=this;this.addAnchor=function(c){var e=document.createElement("a");e.innerHTML="&#10004;";e.classList.add("action");c.element.insertBefore(e,c.element.firstChild);e.onclick=function(f){if(c.series.disabled){c.series.enable();c.element.classList.remove("disabled")}else{c.series.disable();c.element.classList.add("disabled")}};var d=c.element.getElementsByTagName("span")[0];d.onclick=function(j){var h=c.series.disabled;if(!h){for(var g=0;g<a.legend.lines.length;g++){var f=a.legend.lines[g];if(c.series===f.series){}else{if(f.series.disabled){}else{h=true;break}}}}if(h){c.series.enable();c.element.classList.remove("disabled");a.legend.lines.forEach(function(i){if(c.series===i.series){}else{i.series.disable();i.element.classList.add("disabled")}})}else{a.legend.lines.forEach(function(i){i.series.enable();i.element.classList.remove("disabled")})}}};if(this.legend){if(typeof $!="undefined"&&$(this.legend.list).sortable){$(this.legend.list).sortable({start:function(c,d){d.item.bind("no.onclick",function(e){e.preventDefault()})},stop:function(c,d){setTimeout(function(){d.item.unbind("no.onclick")},250)}})}this.legend.lines.forEach(function(c){a.addAnchor(c)})}this._addBehavior=function(){this.graph.series.forEach(function(c){c.disable=function(){if(a.graph.series.length<=1){throw ("only one series left")}c.disabled=true;a.graph.update()};c.enable=function(){c.disabled=false;a.graph.update()}})};this._addBehavior();this.updateBehaviour=function(){this._addBehavior()}};Rickshaw.namespace("Rickshaw.Graph.HoverDetail");Rickshaw.Graph.HoverDetail=Rickshaw.Class.create({initialize:function(a){var c=this.graph=a.graph;this.xFormatter=a.xFormatter||function(d){return new Date(d*1000).toUTCString()};this.yFormatter=a.yFormatter||function(d){return d===null?d:d.toFixed(2)};var b=this.element=document.createElement("div");b.className="detail";this.visible=true;c.element.appendChild(b);this.lastEvent=null;this._addListeners();this.onShow=a.onShow;this.onHide=a.onHide;this.onRender=a.onRender;this.formatter=a.formatter||this.formatter},formatter:function(e,a,g,c,b,f){return e.name+":&nbsp;"+b},update:function(g){g=g||this.lastEvent;if(!g){return}this.lastEvent=g;if(!g.target.nodeName.match(/^(path|svg|rect)$/)){return}var k=this.graph;var b=g.offsetX||g.layerX;var a=g.offsetY||g.layerY;var d=0;var i=[];var h;this.graph.series.active().forEach(function(n){var m=this.graph.stackedData[d++];var j=k.x.invert(b);var p=d3.scale.linear().domain([m[0].x,m.slice(-1)[0].x]).range([0,m.length-1]);var u=Math.round(p(j));var r=Math.min(u||0,m.length-1);for(var o=u;o<m.length-1;){if(!m[o]||!m[o+1]){break}if(m[o].x<=j&&m[o+1].x>j){r=o;break}if(m[o+1].x<=j){o++}else{o--}}if(r<0){r=0}var t=m[r];var e=Math.sqrt(Math.pow(Math.abs(k.x(t.x)-b),2)+Math.pow(Math.abs(k.y(t.y+t.y0)-a),2));var l=n.xFormatter||this.xFormatter;var q=n.yFormatter||this.yFormatter;var s={formattedXValue:l(t.x),formattedYValue:q(n.scale?n.scale.invert(t.y):t.y),series:n,value:t,distance:e,order:d,name:n.name};if(!h||e<h.distance){h=s}i.push(s)},this);h.active=true;var c=h.value.x;var f=h.formattedXValue;this.element.innerHTML="";this.element.style.left=k.x(c)+"px";this.visible&&this.render({points:i,detail:i,mouseX:b,mouseY:a,formattedXValue:f,domainX:c})},hide:function(){this.visible=false;this.element.classList.add("inactive");if(typeof this.onHide=="function"){this.onHide()}},show:function(){this.visible=true;this.element.classList.remove("inactive");if(typeof this.onShow=="function"){this.onShow()}},render:function(f){var j=this.graph;var i=f.points;var g=i.filter(function(l){return l.active}).shift();if(g.value.y===null){return}var e=g.formattedXValue;var h=g.formattedYValue;this.element.innerHTML="";this.element.style.left=j.x(g.value.x)+"px";var c=document.createElement("div");c.className="x_label";c.innerHTML=e;this.element.appendChild(c);var k=document.createElement("div");k.className="item";var d=g.series;var a=d.scale?d.scale.invert(g.value.y):g.value.y;k.innerHTML=this.formatter(d,g.value.x,a,e,h,g);k.style.top=this.graph.y(g.value.y0+g.value.y)+"px";this.element.appendChild(k);var b=document.createElement("div");b.className="dot";b.style.top=k.style.top;b.style.borderColor=d.color;this.element.appendChild(b);if(g.active){k.className="item active";b.className="dot active"}this.show();if(typeof this.onRender=="function"){this.onRender(f)}},_addListeners:function(){this.graph.element.addEventListener("mousemove",function(a){this.visible=true;this.update(a)}.bind(this),false);this.graph.onUpdate(function(){this.update()}.bind(this));this.graph.element.addEventListener("mouseout",function(a){if(a.relatedTarget&&!(a.relatedTarget.compareDocumentPosition(this.graph.element)&Node.DOCUMENT_POSITION_CONTAINS)){this.hide()}}.bind(this),false)}});Rickshaw.namespace("Rickshaw.Graph.JSONP");Rickshaw.Graph.JSONP=Rickshaw.Class.create(Rickshaw.Graph.Ajax,{request:function(){$.ajax({url:this.dataURL,dataType:"jsonp",success:this.success.bind(this),error:this.error.bind(this)})}});Rickshaw.namespace("Rickshaw.Graph.Legend");Rickshaw.Graph.Legend=function(b){var d=this.element=b.element;var f=this.graph=b.graph;var a=this;d.classList.add("rickshaw_legend");var e=this.list=document.createElement("ul");d.appendChild(e);var c=f.series.map(function(g){return g});if(!b.naturalOrder){c=c.reverse()}this.lines=[];this.addLine=function(i){var g=document.createElement("li");g.className="line";if(i.disabled){g.className+=" disabled"}var j=document.createElement("div");j.className="swatch";j.style.backgroundColor=i.color;g.appendChild(j);var h=document.createElement("span");h.className="label";h.innerHTML=i.name;g.appendChild(h);e.appendChild(g);g.series=i;if(i.noLegend){g.style.display="none"}var k={element:g,series:i};if(a.shelving){a.shelving.addAnchor(k);a.shelving.updateBehaviour()}if(a.highlighter){a.highlighter.addHighlightEvents(k)}a.lines.push(k)};c.forEach(function(g){a.addLine(g)});f.onUpdate(function(){})};Rickshaw.namespace("Rickshaw.Graph.RangeSlider");Rickshaw.Graph.RangeSlider=Rickshaw.Class.create({initialize:function(a){var b=this.element=a.element;var c=this.graph=a.graph;this.build();c.onUpdate(function(){this.update()}.bind(this))},build:function(){var a=this.element;var b=this.graph;$(function(){$(a).slider({range:true,min:b.dataDomain()[0],max:b.dataDomain()[1],values:[b.dataDomain()[0],b.dataDomain()[1]],slide:function(c,d){b.window.xMin=d.values[0];b.window.xMax=d.values[1];b.update();if(b.dataDomain()[0]==d.values[0]){b.window.xMin=undefined}if(b.dataDomain()[1]==d.values[1]){b.window.xMax=undefined}}})});a[0].style.width=b.width+"px"},update:function(){var b=this.element;var c=this.graph;var a=$(b).slider("option","values");$(b).slider("option","min",c.dataDomain()[0]);$(b).slider("option","max",c.dataDomain()[1]);if(c.window.xMin==null){a[0]=c.dataDomain()[0]}if(c.window.xMax==null){a[1]=c.dataDomain()[1]}$(b).slider("option","values",a)}});Rickshaw.namespace("Rickshaw.Graph.Renderer");Rickshaw.Graph.Renderer=Rickshaw.Class.create({initialize:function(a){this.graph=a.graph;this.tension=a.tension||this.tension;this.graph.unstacker=this.graph.unstacker||new Rickshaw.Graph.Unstacker({graph:this.graph});this.configure(a)},seriesPathFactory:function(){},seriesStrokeFactory:function(){},defaults:function(){return{tension:0.8,strokeWidth:2,unstack:true,padding:{top:0.01,right:0,bottom:0.01,left:0},stroke:false,fill:false}},domain:function(){var c=this.graph.stackedData||this.graph.stackData();var e=c[0][0];var b=e.x;var f=e.x;var a=e.y+e.y0;var d=e.y+e.y0;c.forEach(function(g){g.forEach(function(h){if(h.y==null){return}var i=h.y+h.y0;if(i<a){a=i}if(i>d){d=i}});if(g[0].x<b){b=g[0].x}if(g[g.length-1].x>f){f=g[g.length-1].x}});b-=(f-b)*this.padding.left;f+=(f-b)*this.padding.right;a=this.graph.min==="auto"?a:this.graph.min||0;d=this.graph.max===undefined?d:this.graph.max;if(this.graph.min==="auto"||a<0){a-=(d-a)*this.padding.bottom}if(this.graph.max===undefined){d+=(d-a)*this.padding.top}return{x:[b,f],y:[a,d]}},render:function(){var c=this.graph;c.vis.selectAll("*").remove();var a=c.vis.selectAll("path").data(this.graph.stackedData).enter().append("svg:path").attr("d",this.seriesPathFactory());var b=0;c.series.forEach(function(d){if(d.disabled){return}d.path=a[0][b++];this._styleSeries(d)},this)},_styleSeries:function(a){var c=this.fill?a.color:"none";var b=this.stroke?a.color:"none";a.path.setAttribute("fill",c);a.path.setAttribute("stroke",b);a.path.setAttribute("stroke-width",this.strokeWidth);a.path.setAttribute("class",a.className)},configure:function(a){a=a||{};Rickshaw.keys(this.defaults()).forEach(function(b){if(!a.hasOwnProperty(b)){this[b]=this[b]||this.graph[b]||this.defaults()[b];return}if(typeof this.defaults()[b]=="object"){Rickshaw.keys(this.defaults()[b]).forEach(function(c){this[b][c]=a[b][c]!==undefined?a[b][c]:this[b][c]!==undefined?this[b][c]:this.defaults()[b][c]},this)}else{this[b]=a[b]!==undefined?a[b]:this[b]!==undefined?this[b]:this.graph[b]!==undefined?this.graph[b]:this.defaults()[b]}},this)},setStrokeWidth:function(a){if(a!==undefined){this.strokeWidth=a}},setTension:function(a){if(a!==undefined){this.tension=a}}});Rickshaw.namespace("Rickshaw.Graph.Renderer.Line");Rickshaw.Graph.Renderer.Line=Rickshaw.Class.create(Rickshaw.Graph.Renderer,{name:"line",defaults:function($super){return Rickshaw.extend($super(),{unstack:true,fill:false,stroke:true})},seriesPathFactory:function(){var b=this.graph;var a=d3.svg.line().x(function(c){return b.x(c.x)}).y(function(c){return b.y(c.y)}).interpolate(this.graph.interpolation).tension(this.tension);a.defined&&a.defined(function(c){return c.y!==null});return a}});Rickshaw.namespace("Rickshaw.Graph.Renderer.Stack");Rickshaw.Graph.Renderer.Stack=Rickshaw.Class.create(Rickshaw.Graph.Renderer,{name:"stack",defaults:function($super){return Rickshaw.extend($super(),{fill:true,stroke:false,unstack:false})},seriesPathFactory:function(){var b=this.graph;var a=d3.svg.area().x(function(c){return b.x(c.x)}).y0(function(c){return b.y(c.y0)}).y1(function(c){return b.y(c.y+c.y0)}).interpolate(this.graph.interpolation).tension(this.tension);a.defined&&a.defined(function(c){return c.y!==null});return a}});Rickshaw.namespace("Rickshaw.Graph.Renderer.Bar");Rickshaw.Graph.Renderer.Bar=Rickshaw.Class.create(Rickshaw.Graph.Renderer,{name:"bar",defaults:function($super){var a=Rickshaw.extend($super(),{gapSize:0.05,unstack:false});delete a.tension;return a},initialize:function($super,a){a=a||{};this.gapSize=a.gapSize||this.gapSize;$super(a)},domain:function($super){var b=$super();var a=this._frequentInterval();b.x[1]+=parseInt(a.magnitude,10);return b},barWidth:function(){var b=this.graph.stackedData||this.graph.stackData();var d=b.slice(-1).shift();var a=this._frequentInterval();var c=this.graph.x(d[0].x+a.magnitude*(1-this.gapSize));return c},render:function(){var e=this.graph;e.vis.selectAll("*").remove();var c=this.barWidth();var d=0;var f=e.series.filter(function(g){return !g.disabled}).length;var a=this.unstack?c/f:c;var b=function(h){var g=[1,0,0,(h.y<0?-1:1),0,(h.y<0?e.y.magnitude(Math.abs(h.y))*2:0)];return"matrix("+g.join(",")+")"};e.series.forEach(function(h){if(h.disabled){return}var g=e.vis.selectAll("path").data(h.stack.filter(function(i){return i.y!==null})).enter().append("svg:rect").attr("x",function(i){return e.x(i.x)+d}).attr("y",function(i){return(e.y(i.y0+Math.abs(i.y)))*(i.y<0?-1:1)}).attr("width",a).attr("height",function(i){return e.y.magnitude(Math.abs(i.y))}).attr("transform",b);Array.prototype.forEach.call(g[0],function(i){i.setAttribute("fill",h.color)});if(this.unstack){d+=a}},this)},_frequentInterval:function(){var d=this.graph.stackedData||this.graph.stackData();var f=d.slice(-1).shift();var e={};for(var c=0;c<f.length-1;c++){var a=f[c+1].x-f[c].x;e[a]=e[a]||0;e[a]++}var b={count:0};Rickshaw.keys(e).forEach(function(g){if(b.count<e[g]){b={count:e[g],magnitude:g}}});this._frequentInterval=function(){return b};return b}});Rickshaw.namespace("Rickshaw.Graph.Renderer.Area");Rickshaw.Graph.Renderer.Area=Rickshaw.Class.create(Rickshaw.Graph.Renderer,{name:"area",defaults:function($super){return Rickshaw.extend($super(),{unstack:false,fill:false,stroke:false})},seriesPathFactory:function(){var b=this.graph;var a=d3.svg.area().x(function(c){return b.x(c.x)}).y0(function(c){return b.y(c.y0)}).y1(function(c){return b.y(c.y+c.y0)}).interpolate(b.interpolation).tension(this.tension);a.defined&&a.defined(function(c){return c.y!==null});return a},seriesStrokeFactory:function(){var b=this.graph;var a=d3.svg.line().x(function(c){return b.x(c.x)}).y(function(c){return b.y(c.y+c.y0)}).interpolate(b.interpolation).tension(this.tension);a.defined&&a.defined(function(c){return c.y!==null});return a},render:function(){var c=this.graph;c.vis.selectAll("*").remove();var d=this.unstack?"append":"insert";var a=c.vis.selectAll("path").data(this.graph.stackedData).enter()[d]("svg:g","g");a.append("svg:path").attr("d",this.seriesPathFactory()).attr("class","area");if(this.stroke){a.append("svg:path").attr("d",this.seriesStrokeFactory()).attr("class","line")}var b=0;c.series.forEach(function(e){if(e.disabled){return}e.path=a[0][b++];this._styleSeries(e)},this)},_styleSeries:function(a){if(!a.path){return}d3.select(a.path).select(".area").attr("fill",a.color);if(this.stroke){d3.select(a.path).select(".line").attr("fill","none").attr("stroke",a.stroke||d3.interpolateRgb(a.color,"black")(0.125)).attr("stroke-width",this.strokeWidth)}if(a.className){a.path.setAttribute("class",a.className)}}});Rickshaw.namespace("Rickshaw.Graph.Renderer.ScatterPlot");Rickshaw.Graph.Renderer.ScatterPlot=Rickshaw.Class.create(Rickshaw.Graph.Renderer,{name:"scatterplot",defaults:function($super){return Rickshaw.extend($super(),{unstack:true,fill:true,stroke:false,padding:{top:0.01,right:0.01,bottom:0.01,left:0.01},dotSize:4})},initialize:function($super,a){$super(a)},render:function(){var a=this.graph;a.vis.selectAll("*").remove();a.series.forEach(function(c){if(c.disabled){return}var b=a.vis.selectAll("path").data(c.stack.filter(function(e){return e.y!==null})).enter().append("svg:circle").attr("cx",function(e){return a.x(e.x)}).attr("cy",function(e){return a.y(e.y)}).attr("r",function(e){return("r" in e)?e.r:a.renderer.dotSize});Array.prototype.forEach.call(b[0],function(d){d.setAttribute("fill",c.color)})},this)}});Rickshaw.namespace("Rickshaw.Graph.Smoother");Rickshaw.Graph.Smoother=Rickshaw.Class.create({initialize:function(a){this.graph=a.graph;this.element=a.element;this.aggregationScale=1;this.build();this.graph.stackData.hooks.data.push({name:"smoother",orderPosition:50,f:this.transformer.bind(this)})},build:function(){var a=this;if(this.element){$(function(){$(a.element).slider({min:1,max:100,slide:function(b,c){a.setScale(c.value);a.graph.update()}})})}},setScale:function(a){if(a<1){throw"scale out of range: "+a}this.aggregationScale=a;this.graph.update()},transformer:function(b){if(this.aggregationScale==1){return b}var a=[];b.forEach(function(f){var c=[];while(f.length){var e=0,d=0;var g=f.splice(0,this.aggregationScale);g.forEach(function(h){e+=h.x/g.length;d+=h.y/g.length});c.push({x:e,y:d})}a.push(c)}.bind(this));return a}});Rickshaw.namespace("Rickshaw.Graph.Unstacker");Rickshaw.Graph.Unstacker=function(b){this.graph=b.graph;var a=this;this.graph.stackData.hooks.after.push({name:"unstacker",f:function(c){if(!a.graph.renderer.unstack){return c}c.forEach(function(d){d.forEach(function(e){e.y0=0})});return c}})};Rickshaw.namespace("Rickshaw.Series");Rickshaw.Series=Rickshaw.Class.create(Array,{initialize:function(d,a,c){c=c||{};this.palette=new Rickshaw.Color.Palette(a);this.timeBase=typeof(c.timeBase)==="undefined"?Math.floor(new Date().getTime()/1000):c.timeBase;var b=typeof(c.timeInterval)=="undefined"?1000:c.timeInterval;this.setTimeInterval(b);if(d&&(typeof(d)=="object")&&Array.isArray(d)){d.forEach(function(e){this.addItem(e)},this)}},addItem:function(a){if(typeof(a.name)==="undefined"){throw ("addItem() needs a name")}a.color=(a.color||this.palette.color(a.name));a.data=(a.data||[]);if((a.data.length===0)&&this.length&&(this.getIndex()>0)){this[0].data.forEach(function(b){a.data.push({x:b.x,y:0})})}else{if(a.data.length===0){a.data.push({x:this.timeBase-(this.timeInterval||0),y:0})}}this.push(a);if(this.legend){this.legend.addLine(this.itemByName(a.name))}},addData:function(b){var a=this.getIndex();Rickshaw.keys(b).forEach(function(c){if(!this.itemByName(c)){this.addItem({name:c})}},this);this.forEach(function(c){c.data.push({x:(a*this.timeInterval||1)+this.timeBase,y:(b[c.name]||0)})},this)},getIndex:function(){return(this[0]&&this[0].data&&this[0].data.length)?this[0].data.length:0},itemByName:function(a){for(var b=0;b<this.length;b++){if(this[b].name==a){return this[b]}}},setTimeInterval:function(a){this.timeInterval=a/1000},setTimeBase:function(a){this.timeBase=a},dump:function(){var a={timeBase:this.timeBase,timeInterval:this.timeInterval,items:[]};this.forEach(function(c){var b={color:c.color,name:c.name,data:[]};c.data.forEach(function(d){b.data.push({x:d.x,y:d.y})});a.items.push(b)});return a},load:function(a){if(a.timeInterval){this.timeInterval=a.timeInterval}if(a.timeBase){this.timeBase=a.timeBase}if(a.items){a.items.forEach(function(b){this.push(b);if(this.legend){this.legend.addLine(this.itemByName(b.name))}},this)}}});Rickshaw.Series.zeroFill=function(a){Rickshaw.Series.fill(a,0)};Rickshaw.Series.fill=function(c,e){var a;var b=0;var d=c.map(function(f){return f.data});while(b<Math.max.apply(null,d.map(function(f){return f.length}))){a=Math.min.apply(null,d.filter(function(f){return f[b]}).map(function(f){return f[b].x}));d.forEach(function(f){if(!f[b]||f[b].x!=a){f.splice(b,0,{x:a,y:e})}});b++}};Rickshaw.namespace("Rickshaw.Series.FixedDuration");Rickshaw.Series.FixedDuration=Rickshaw.Class.create(Rickshaw.Series,{initialize:function(d,a,b){b=b||{};if(typeof(b.timeInterval)==="undefined"){throw new Error("FixedDuration series requires timeInterval")}if(typeof(b.maxDataPoints)==="undefined"){throw new Error("FixedDuration series requires maxDataPoints")}this.palette=new Rickshaw.Color.Palette(a);this.timeBase=typeof(b.timeBase)==="undefined"?Math.floor(new Date().getTime()/1000):b.timeBase;this.setTimeInterval(b.timeInterval);if(this[0]&&this[0].data&&this[0].data.length){this.currentSize=this[0].data.length;this.currentIndex=this[0].data.length}else{this.currentSize=0;this.currentIndex=0}this.maxDataPoints=b.maxDataPoints;if(d&&(typeof(d)=="object")&&Array.isArray(d)){d.forEach(function(e){this.addItem(e)},this);this.currentSize+=1;this.currentIndex+=1}this.timeBase-=(this.maxDataPoints-this.currentSize)*this.timeInterval;if((typeof(this.maxDataPoints)!=="undefined")&&(this.currentSize<this.maxDataPoints)){for(var c=this.maxDataPoints-this.currentSize-1;c>0;c--){this.currentSize+=1;this.currentIndex+=1;this.forEach(function(e){e.data.unshift({x:((c-1)*this.timeInterval||1)+this.timeBase,y:0,i:c})},this)}}},addData:function($super,a){$super(a);this.currentSize+=1;this.currentIndex+=1;if(this.maxDataPoints!==undefined){while(this.currentSize>this.maxDataPoints){this.dropData()}}},dropData:function(){this.forEach(function(a){a.data.splice(0,1)});this.currentSize-=1},getIndex:function(){return this.currentIndex}});